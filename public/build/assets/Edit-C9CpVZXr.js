import{C as M,r as b,c as m,o as p,a as r,u as s,m as E,w as f,b as t,d as G,h as N,i as O,n as T,q as j,F as y,k as q,t as x,P as h,f as _,W as w}from"./app-B-T-605q.js";import{_ as A}from"./AuthenticatedLayout-DpJlYc1e.js";import{_ as V}from"./DSTooltip.vue_vue_type_style_index_0_lang-BcgYgaom.js";import{_ as c}from"./Input-AYEED9p3.js";import{_ as B}from"./AlertModal-BtgW-cJO.js";import{_ as L}from"./DSDurationInput-mWvxfwzb.js";import P from"./AddFileSection-BcLV31I6.js";import"./app-BxuWAwOE.js";import"./Alert-BqfI2gRb.js";import"./Modal-BtKdiqsm.js";import"./transition-D7vOtQpP.js";const H={class:"flex justify-between items-center"},W={class:"text-sm text-gray-600"},z={class:"py-12"},R={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},Y={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},I={class:"p-6"},J={class:"grid grid-cols-2 gap-4"},K={class:"mt-1"},Q={key:0,class:"space-y-4"},X={class:"space-y-2"},Z={class:"flex-1"},ee={class:"text-sm font-medium text-neutral-900"},te={class:"text-sm text-neutral-500"},oe={class:"flex items-center space-x-2"},se=["onClick"],ne={class:"flex items-center justify-end gap-4"},le={key:0},re={key:1},ye={__name:"Edit",props:{band:{type:Object,required:!0},song:{type:Object,required:!0}},setup(d){const k=n=>{const e=Math.floor(n/60),i=n%60;return`${e}:${i.toString().padStart(2,"0")}`},a=d,o=M({band_id:a.band.id,name:a.song.name,artist:a.song.artist,duration:k(a.song.duration_seconds),duration_seconds:a.song.duration_seconds,notes:a.song.notes,url:a.song.url,files:[]}),u=b([]),g=b(null),v=b(null),S=()=>{u.value.length<10&&u.value.push({type:"",instrument:null,file:null})},F=n=>{u.value.splice(n,1)},$=(n,e)=>{const i=n.target.files[0];i&&(u.value[e].file=i)},D=n=>{v.value=n,g.value.open()},C=()=>{w.delete(route("songs.files.destroy",[a.band.id,a.song.id,v.value.id]),{preserveScroll:!0,onSuccess:()=>{g.value.close(),v.value=null}})},U=()=>{const n=new FormData;n.append("_method","PATCH"),n.append("band_id",o.band_id.toString()),n.append("name",o.name),n.append("duration_seconds",o.duration_seconds.toString()),o.artist&&n.append("artist",o.artist),o.duration&&n.append("duration",o.duration),o.notes&&n.append("notes",o.notes),o.url&&n.append("url",o.url),u.value.filter(e=>e.file&&e.type).forEach((e,i)=>{n.append(`files[${i}][type]`,e.type),n.append(`files[${i}][instrument]`,e.instrument),n.append(`files[${i}][file]`,e.file)}),w.post(route("songs.update",[a.band.id,a.song.id]),n,{preserveScroll:!0,forceFormData:!0})};return(n,e)=>(p(),m(y,null,[r(s(E),{title:`Edit ${d.song.name} - ${d.band.name}`},null,8,["title"]),r(A,null,{header:f(()=>[t("div",H,[t("div",null,[e[7]||(e[7]=t("h2",{class:"text-xl font-semibold leading-tight text-gray-800"}," Edit Song ",-1)),t("p",W,x(d.band.name),1)])])]),default:f(()=>{var i;return[t("div",z,[t("div",R,[t("div",Y,[t("div",I,[t("form",{onSubmit:G(U,["prevent"]),class:"space-y-6"},[t("div",J,[t("div",null,[r(s(c),{modelValue:s(o).name,"onUpdate:modelValue":e[0]||(e[0]=l=>s(o).name=l),type:"text",label:"Song Name",error:s(o).errors.name,required:""},null,8,["modelValue","error"])]),t("div",null,[r(s(c),{modelValue:s(o).artist,"onUpdate:modelValue":e[1]||(e[1]=l=>s(o).artist=l),type:"text",label:"Artist (Optional)",error:s(o).errors.artist,placeholder:""},null,8,["modelValue","error"])]),t("div",null,[r(s(L),{modelValue:s(o).duration,"onUpdate:modelValue":e[2]||(e[2]=l=>s(o).duration=l),"onUpdate:seconds":e[3]||(e[3]=l=>s(o).duration_seconds=l),label:"Duration",required:""},null,8,["modelValue"])]),t("div",null,[r(s(c),{modelValue:s(o).bpm,"onUpdate:modelValue":e[4]||(e[4]=l=>s(o).bpm=l),type:"number",label:"BPM (Optional)",error:s(o).errors.bpm},null,8,["modelValue","error"])])]),t("div",null,[e[8]||(e[8]=t("label",{class:"block text-sm font-medium text-neutral-700"}," Notes (Optional) ",-1)),t("div",K,[O(t("textarea",{"onUpdate:modelValue":e[5]||(e[5]=l=>s(o).notes=l),rows:"4",class:T(["block w-full rounded-lg shadow-sm transition-colors duration-200","border-neutral-300 focus:border-primary-500 focus:ring-primary-500",{"border-error-500 focus:border-error-500 focus:ring-error-500":s(o).errors.notes}])},null,2),[[j,s(o).notes]])]),e[9]||(e[9]=t("p",{class:"mt-1 text-sm text-neutral-500"}," Add any notes about the song, such as key changes or special instructions ",-1))]),t("div",null,[r(s(c),{modelValue:s(o).url,"onUpdate:modelValue":e[6]||(e[6]=l=>s(o).url=l),type:"url",label:"External Link (Optional)",error:s(o).errors.url,placeholder:"https://"},null,8,["modelValue","error"]),e[10]||(e[10]=t("p",{class:"mt-1 text-sm text-neutral-500"}," Link to an external resource (YouTube, Spotify, etc.) ",-1))]),(i=d.song.files)!=null&&i.length?(p(),m("div",Q,[e[13]||(e[13]=t("h3",{class:"text-lg font-medium text-neutral-900"},"Existing Files",-1)),t("div",X,[(p(!0),m(y,null,q(d.song.files,l=>(p(),m("div",{key:l.id,class:"flex items-center gap-4 border rounded-md p-3"},[t("div",Z,[t("span",ee,x(l.type),1),t("p",te,x(l.original_filename),1)]),t("div",oe,[r(s(h),{href:n.route("songs.files.download",[d.band.id,d.song.id,l.id]),class:"text-primary-600 hover:text-primary-700"},{default:f(()=>e[11]||(e[11]=[_(" Download ")])),_:2},1032,["href"]),t("button",{type:"button",onClick:ae=>D(l),class:"text-neutral-400 hover:text-neutral-500"},e[12]||(e[12]=[t("span",{class:"sr-only"},"Delete",-1),t("svg",{class:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]),8,se)])]))),128))])])):N("",!0),r(P,{fileGroups:u.value,onAddFileGroup:S,onRemoveFileGroup:F,onHandleFileUpload:$},null,8,["fileGroups"]),t("div",ne,[r(s(h),{href:n.route("songs.show",[d.band.id,d.song.id])},{default:f(()=>[r(s(V),{type:"button",variant:"outline"},{default:f(()=>e[14]||(e[14]=[_(" Cancel ")])),_:1})]),_:1},8,["href"]),r(s(V),{type:"submit",variant:"primary",disabled:s(o).processing},{default:f(()=>[s(o).processing?(p(),m("span",le,"Saving...")):(p(),m("span",re,"Save Changes"))]),_:1},8,["disabled"])])],32)])])])])]}),_:1}),r(s(B),{ref_key:"deleteModal",ref:g,title:"Delete File",message:"Are you sure you want to delete this file? This action cannot be undone.",type:"error","confirm-text":"Delete","show-cancel":!0,onConfirm:C},null,512)],64))}};export{ye as default};
