import{C as F,r as g,l as P,c as u,o as d,a as o,u as l,m as q,w as r,b as s,d as E,e as C,h as w,F as k,j as M,t as h,f as m,P as V,a5 as O}from"./app-CdR4EPip.js";import{_ as R}from"./AuthenticatedLayout-C17kwXOB.js";import{_ as y}from"./Button-CTmYF_Xu.js";import{_}from"./Input-CWYxiZL3.js";import{_ as H}from"./Card-BfVXW81P.js";import{_ as U}from"./Alert-CyAww-Mn.js";import{_ as T}from"./Modal-ByUYzhUS.js";import{V as G}from"./transition-C0cL-Eqc.js";const X={class:"md:flex md:items-center md:justify-between"},J={class:"min-w-0 flex-1"},K={class:"flex items-center"},Q={class:"list-disc list-inside"},W={class:"overflow-x-auto"},Y={class:"min-w-[800px]"},Z={class:"col-span-4"},ee={class:"col-span-2"},se={class:"col-span-3"},te={class:"col-span-2"},le={class:"col-span-1 flex justify-end items-center"},oe=["onClick"],ae={class:"p-4 md:p-6 flex flex-col sm:flex-row justify-between space-y-4 sm:space-y-0"},ne={class:"flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-3"},re={class:"flex space-x-3"},ie={key:0},de={key:1},ue={class:"space-y-4"},me={class:"mt-6 flex justify-end space-x-3"},ce={key:0},pe={key:1},$=30,we={__name:"BulkCreate",props:{band:{type:Object,required:!0}},setup(p){const A=p,a=F({songs:[{name:"",duration:"",duration_seconds:"",url:"",artist:""}]});g({});const S=P(()=>a.songs.length<$),j=()=>{S.value&&a.songs.push({name:"",duration:"",duration_seconds:"",url:"",artist:""})},B=i=>{a.songs.length>1&&a.songs.splice(i,1)},I=i=>{const e=i.replace(/\D/g,"");if(e.length<=2)return e;const t=e.slice(0,-2),c=e.slice(-2);return`${t}:${c}`},D=i=>{const[e,t]=i.split(":").map(Number);return e*60+(t||0)},N=(i,e)=>{const t=I(e.target.value);a.songs[i].duration=t,a.songs[i].duration_seconds=D(t)},x=g(!1),f=g(""),v=g(!1),b=g(null),L=async()=>{var i,e;if(f.value){v.value=!0,b.value=null;try{const c=(await O.post(route("spotify.playlist-tracks"),{playlist_url:f.value})).data.tracks;a.songs=c.map(n=>({name:n.name,duration:n.duration,duration_seconds:n.duration_seconds,url:n.url,artist:n.artist})),x.value=!1,f.value=""}catch(t){b.value=((e=(i=t.response)==null?void 0:i.data)==null?void 0:e.error)||"Failed to import playlist"}finally{v.value=!1}}},z=()=>{a.post(route("songs.bulk-store",A.band.id),{preserveScroll:!0,onSuccess:()=>{a.reset(),a.songs=[{name:"",duration:"",duration_seconds:"",url:"",artist:""}]}})};return(i,e)=>(d(),u(k,null,[o(l(q),{title:`Add Multiple Songs - ${p.band.name}`},null,8,["title"]),o(R,null,{header:r(()=>[s("div",X,[s("div",J,[s("div",K,[o(l(V),{href:i.route("bands.show",p.band.id),class:"text-sm font-medium text-primary-600 hover:text-primary-700"},{default:r(()=>[m(h(p.band.name),1)]),_:1},8,["href"]),e[5]||(e[5]=s("svg",{class:"mx-2 h-5 w-5 text-neutral-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)),o(l(V),{href:i.route("songs.index",p.band.id),class:"text-sm font-medium text-primary-600 hover:text-primary-700"},{default:r(()=>e[4]||(e[4]=[m(" Songs ")])),_:1},8,["href"])]),e[6]||(e[6]=s("h2",{class:"mt-1 text-2xl font-bold leading-7 text-neutral-900 sm:truncate sm:text-3xl sm:tracking-tight"}," Add Multiple Songs ",-1)),s("p",{class:"mt-1 text-sm text-neutral-500"}," Add up to "+h($)+" songs at once ")])])]),default:r(()=>[o(l(H),null,{default:r(()=>[s("form",{onSubmit:E(z,["prevent"]),class:"divide-y divide-neutral-200"},[Object.keys(l(a).errors).length>0?(d(),C(l(U),{key:0,type:"error",class:"m-6"},{default:r(()=>[s("ul",Q,[(d(!0),u(k,null,M(l(a).errors,t=>(d(),u("li",{key:t},h(t),1))),128))])]),_:1})):w("",!0),s("div",W,[s("div",Y,[e[8]||(e[8]=s("div",{class:"grid grid-cols-12 gap-3 px-3 py-2 bg-neutral-50 border-b"},[s("div",{class:"col-span-4"},"Song Name"),s("div",{class:"col-span-2"},"Duration"),s("div",{class:"col-span-3"},"Artist"),s("div",{class:"col-span-2"},"URL"),s("div",{class:"col-span-1"})],-1)),(d(!0),u(k,null,M(l(a).songs,(t,c)=>(d(),u("div",{key:c,class:"grid grid-cols-12 gap-3 px-3 py-2 border-b last:border-b-0"},[s("div",Z,[o(l(_),{modelValue:t.name,"onUpdate:modelValue":n=>t.name=n,type:"text",placeholder:"Song name",required:"",class:"w-full"},null,8,["modelValue","onUpdate:modelValue"])]),s("div",ee,[o(l(_),{modelValue:t.duration,"onUpdate:modelValue":n=>t.duration=n,type:"text",placeholder:"MM:SS",onInput:n=>N(c,n),required:"",class:"w-full"},null,8,["modelValue","onUpdate:modelValue","onInput"])]),s("div",se,[o(l(_),{modelValue:t.artist,"onUpdate:modelValue":n=>t.artist=n,type:"text",placeholder:"Artist name",class:"w-full"},null,8,["modelValue","onUpdate:modelValue"])]),s("div",te,[o(l(_),{modelValue:t.url,"onUpdate:modelValue":n=>t.url=n,type:"url",placeholder:"https://",class:"w-full"},null,8,["modelValue","onUpdate:modelValue"])]),s("div",le,[l(a).songs.length>1?(d(),u("button",{key:0,type:"button",class:"p-2 text-neutral-400 hover:text-danger-500",onClick:n=>B(c)},e[7]||(e[7]=[s("svg",{class:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)]),8,oe)):w("",!0)])]))),128))])]),s("div",ae,[s("div",ne,[o(l(y),{type:"button",variant:"secondary",disabled:!S.value,onClick:j,class:"w-full sm:w-auto"},{default:r(()=>e[9]||(e[9]=[s("svg",{class:"-ml-0.5 mr-1.5 h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),m(" Add Another Song ")])),_:1},8,["disabled"]),o(l(y),{type:"button",variant:"secondary",onClick:e[0]||(e[0]=t=>x.value=!0),class:"w-full sm:w-auto"},{default:r(()=>e[10]||(e[10]=[s("svg",{class:"-ml-0.5 mr-1.5 h-4 w-4",viewBox:"0 0 24 24",fill:"currentColor"},[s("path",{d:"M12 0C5.4 0 0 5.4 0 12s5.4 12 12 12 12-5.4 12-12S18.66 0 12 0zm5.521 17.34c-.24.359-.66.48-1.021.24-2.82-1.74-6.36-2.101-10.561-1.141-.418.122-.779-.179-.899-.539-.12-.421.18-.78.54-.9 4.56-1.021 8.52-.6 11.64 1.32.42.18.479.659.301 1.02zm1.44-3.3c-.301.42-.841.6-1.262.3-3.239-1.98-8.159-2.58-11.939-1.38-.479.12-1.02-.12-1.14-.6-.12-.48.12-1.021.6-1.141C9.6 9.9 15 10.561 18.72 12.84c.361.181.54.78.241 1.2zm.12-3.36C15.24 8.4 8.82 8.16 5.16 9.301c-.6.179-1.2-.181-1.38-.721-.18-.601.18-1.2.72-1.381 4.26-1.26 11.28-1.02 15.721 1.621.539.3.719 1.02.419 1.56-.299.421-1.02.599-1.559.3z"})],-1),m(" Import from Spotify ")])),_:1})]),s("div",re,[o(l(V),{href:i.route("songs.index",p.band.id),class:"flex-1 sm:flex-none"},{default:r(()=>[o(l(y),{variant:"outline",class:"w-full sm:w-auto"},{default:r(()=>e[11]||(e[11]=[m(" Cancel ")])),_:1})]),_:1},8,["href"]),o(l(y),{type:"submit",variant:"primary",disabled:l(a).processing,class:"flex-1 sm:w-auto"},{default:r(()=>[l(a).processing?(d(),u("span",ie,"Saving...")):(d(),u("span",de,"Save All Songs"))]),_:1},8,["disabled"])])])],32)]),_:1}),o(l(T),{show:x.value,onClose:e[3]||(e[3]=t=>x.value=!1),"max-width":"lg"},{default:r(()=>[o(l(G),{as:"h3",class:"text-lg font-medium leading-6 text-neutral-900 mb-4"},{default:r(()=>e[12]||(e[12]=[m(" Import from Spotify Playlist ")])),_:1}),s("div",ue,[e[13]||(e[13]=s("p",{class:"text-sm text-neutral-600"}," Enter a Spotify playlist URL or ID to import its tracks. ",-1)),b.value?(d(),C(l(U),{key:0,type:"error",class:"mb-4"},{default:r(()=>[m(h(b.value),1)]),_:1})):w("",!0),o(l(_),{modelValue:f.value,"onUpdate:modelValue":e[1]||(e[1]=t=>f.value=t),label:"Playlist URL",placeholder:"https://open.spotify.com/playlist/...",disabled:v.value},null,8,["modelValue","disabled"])]),s("div",me,[o(l(y),{variant:"outline",onClick:e[2]||(e[2]=t=>x.value=!1),disabled:v.value},{default:r(()=>e[14]||(e[14]=[m(" Cancel ")])),_:1},8,["disabled"]),o(l(y),{variant:"primary",onClick:L,disabled:!f.value||v.value},{default:r(()=>[v.value?(d(),u("span",ce,"Importing...")):(d(),u("span",pe,"Import Tracks"))]),_:1},8,["disabled"])])]),_:1},8,["show"])]),_:1})],64))}};export{we as default};
