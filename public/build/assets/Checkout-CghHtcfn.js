import{c as i,o,b as e,r as l,l as N,e as D,w as C,a as y,u as g,m as E,h,t as a,f as B,F,j,d as I,i as L,q as M,D as V,W as U}from"./app-CuLzN9lL.js";import{_ as Z}from"./AuthenticatedLayout-Cq0JzR9A.js";import{_ as A}from"./DSTooltip.vue_vue_type_style_index_0_lang-CTcchv1t.js";import"./app-CTM3tqIB.js";function O(r,s){return o(),i("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"fill-rule":"evenodd",d:"M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12Zm13.36-1.814a.75.75 0 1 0-1.22-.872l-3.236 4.53L9.53 12.22a.75.75 0 0 0-1.06 1.06l2.25 2.25a.75.75 0 0 0 1.14-.094l3.75-5.25Z","clip-rule":"evenodd"})])}function T(r,s){return o(),i("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"fill-rule":"evenodd",d:"M12 1.5a5.25 5.25 0 0 0-5.25 5.25v3a3 3 0 0 0-3 3v6.75a3 3 0 0 0 3 3h10.5a3 3 0 0 0 3-3v-6.75a3 3 0 0 0-3-3v-3c0-2.9-2.35-5.25-5.25-5.25Zm3.75 8.25v-3a3.75 3.75 0 1 0-7.5 0v3h7.5Z","clip-rule":"evenodd"})])}const Y={class:"max-w-3xl mx-auto py-8 px-4 sm:px-6 lg:px-8"},$={key:0,class:"mb-4 p-4 bg-red-50 border border-red-200 rounded-md"},K={class:"text-red-600"},W={key:1,class:"mb-8 p-4 bg-blue-50 border border-blue-200 rounded-md"},z={class:"text-blue-700"},H={class:"grid grid-cols-1 gap-8 md:grid-cols-2"},G={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},J={class:"flex justify-between items-center mb-4 pb-4 border-b border-gray-100"},Q={class:"font-medium text-gray-900"},R={class:"text-right"},X={class:"text-lg"},ee={class:"text-red-400 line-through mr-2"},te={class:"font-bold text-gray-900"},re={class:"space-y-3 mb-6"},se={class:"ml-3 text-sm text-gray-600"},ae={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},oe={class:"mb-4"},ie={class:"mb-6"},ne={key:0,class:"mt-1 text-sm text-red-600"},le={key:0},de={key:1},ce={class:"mt-4 flex items-center justify-center text-sm text-gray-500"},ye={__name:"Checkout",props:{band:{type:Object,required:!0,validator:r=>r.name&&typeof r.name=="string"},trialDaysLeft:{type:Number,required:!0},stripeKey:{type:String,required:!0},clientSecret:{type:String,required:!0},formattedPrice:{type:String,required:!0},pricing:{type:Object,required:!0,default:()=>({})},priceId:{type:String,required:!0}},setup(r){const s=r;console.log("Checkout props:",{band:s.band,pricing:s.pricing,priceId:s.priceId,formattedPrice:s.formattedPrice});const m=l(null),p=l(null),f=l(""),c=l(!1),b=l(null),_=l(null),v=l(null),P=["Unlimited free band members","Unlimited songs","Unlimited setlists","Full access for all band members","Cloud backup and sync","Performance mode","File attachments support","Priority email support"];N(()=>{b.value=Stripe(s.stripeKey),v.value=b.value.elements();const d=v.value.create("card",{style:{base:{fontSize:"16px",color:"#374151","::placeholder":{color:"#9CA3AF"}}}});d.mount(_.value),d.on("change",t=>{p.value=t.error?t.error.message:""})});const q=async()=>{var d,t,n;if(!c.value){c.value=!0,p.value=null,m.value=null;try{const{setupIntent:u,error:w}=await b.value.confirmCardSetup(s.clientSecret,{payment_method:{card:v.value.getElement("card"),billing_details:{name:f.value}}});if(w)throw new Error(w.message);const x={band_id:s.band.id,payment_method:u.payment_method,price_id:s.priceId};(d=s.pricing)!=null&&d.currency&&(x.currency=s.pricing.currency,x.amount=s.pricing.amount);const{data:S}=await V.post(route("subscription.create"),x);if(S.status==="requires_action"){const{error:k}=await b.value.confirmCardPayment(S.payment_intent_client_secret);if(k)throw new Error(k.message)}U.visit(route("subscription.index"),{preserveScroll:!0})}catch(u){console.error("Subscription error:",u),m.value=((n=(t=u.response)==null?void 0:t.data)==null?void 0:n.message)||u.message||"An error occurred during checkout. Please try again."}finally{c.value=!1}}};return(d,t)=>(o(),D(Z,null,{default:C(()=>[y(g(E),{title:"Subscribe to Setlix"}),e("div",Y,[m.value?(o(),i("div",$,[e("p",K,a(m.value),1)])):h("",!0),r.trialDaysLeft>0?(o(),i("div",W,[e("p",z," You have "+a(r.trialDaysLeft)+" days left in your trial period for "+a(r.band.name),1)])):h("",!0),e("div",H,[e("div",null,[e("div",G,[t[3]||(t[3]=e("h2",{class:"text-xl font-semibold text-gray-900 mb-4"},"Subscription Details",-1)),e("div",J,[e("div",null,[e("p",Q,a(r.band.name),1),t[1]||(t[1]=e("p",{class:"text-sm text-gray-500"},"Yearly Subscription",-1))]),e("div",R,[e("p",X,[e("span",ee,a(r.pricing.symbol)+a(r.pricing.amount*2),1),e("span",te,a(r.formattedPrice),1)]),t[2]||(t[2]=e("p",{class:"text-sm text-gray-500"},[B("per year "),e("span",{class:"text-green-600 font-medium"},"50% OFF")],-1))])]),e("ul",re,[(o(),i(F,null,j(P,n=>e("li",{key:n,class:"flex items-start"},[y(g(O),{class:"h-5 w-5 text-green-500 flex-shrink-0"}),e("span",se,a(n),1)])),64))])])]),e("div",ae,[t[7]||(t[7]=e("h2",{class:"text-xl font-semibold text-gray-900 mb-4"},"Payment Information",-1)),e("form",{onSubmit:I(q,["prevent"])},[e("div",oe,[t[4]||(t[4]=e("label",{for:"cardName",class:"block text-sm font-medium text-gray-700 mb-1"}," Card Holder Name ",-1)),L(e("input",{id:"cardName","onUpdate:modelValue":t[0]||(t[0]=n=>f.value=n),type:"text",class:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",required:""},null,512),[[M,f.value]])]),e("div",ie,[t[5]||(t[5]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Card Details ",-1)),e("div",{ref_key:"cardElement",ref:_,class:"p-3 border rounded-md border-gray-300 bg-white"},null,512),p.value?(o(),i("div",ne,a(p.value),1)):h("",!0)]),y(g(A),{type:"submit",variant:"primary",class:"w-full justify-center",disabled:c.value},{default:C(()=>[c.value?(o(),i("span",le,"Processing...")):(o(),i("span",de,"Subscribe Now â€¢ "+a(r.formattedPrice)+"/year",1))]),_:1},8,["disabled"])],32),e("div",ce,[y(g(T),{class:"h-4 w-4 mr-1"}),t[6]||(t[6]=e("span",null,"Secure payment powered by Stripe",-1))])])]),t[8]||(t[8]=e("div",{class:"mt-6 text-center text-sm text-gray-500"},[e("p",null,"By subscribing, you agree to our Terms of Service. You can cancel anytime.")],-1))])]),_:1}))}};export{ye as default};
