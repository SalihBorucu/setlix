import{C as F,r as _,l as P,c as m,o as d,a as o,u as s,m as q,w as r,b as l,d as E,e as C,h as k,F as w,j as M,t as x,f as p,P as V,a3 as O}from"./app-RtlUSPMi.js";import{_ as R}from"./AuthenticatedLayout-CDZD8L8b.js";import{_ as y}from"./Button-D2tZ0rOX.js";import{_ as g}from"./Input-ByC62vXA.js";import{_ as H}from"./Card-ucR7er3D.js";import{_ as U}from"./Alert-BLEPqtun.js";import{_ as T}from"./Modal-Bbby0p6L.js";import{V as G}from"./transition-CKTzeSmA.js";const X={class:"md:flex md:items-center md:justify-between"},J={class:"min-w-0 flex-1"},K={class:"flex items-center"},Q={class:"list-disc list-inside"},W={class:"flex-1"},Y={class:"w-32"},Z={class:"w-48"},ee={class:"w-48"},te={class:"flex items-end"},se=["onClick"],le={class:"p-6 flex items-center justify-between"},oe={class:"flex space-x-3"},ae={class:"flex space-x-3"},ne={key:0},re={key:1},ie={class:"space-y-4"},de={class:"mt-6 flex justify-end space-x-3"},ue={key:0},me={key:1},$=30,he={__name:"BulkCreate",props:{band:{type:Object,required:!0}},setup(c){const A=c,a=F({songs:[{name:"",duration:"",duration_seconds:"",url:"",artist:""}]});_({});const S=P(()=>a.songs.length<$),j=()=>{S.value&&a.songs.push({name:"",duration:"",duration_seconds:"",url:"",artist:""})},B=i=>{a.songs.length>1&&a.songs.splice(i,1)},I=i=>{const e=i.replace(/\D/g,"");if(e.length<=2)return e;const t=e.slice(0,-2),u=e.slice(-2);return`${t}:${u}`},D=i=>{const[e,t]=i.split(":").map(Number);return e*60+(t||0)},N=(i,e)=>{const t=I(e.target.value);a.songs[i].duration=t,a.songs[i].duration_seconds=D(t)},b=_(!1),f=_(""),v=_(!1),h=_(null),L=async()=>{var i,e;if(f.value){v.value=!0,h.value=null;try{const u=(await O.post(route("spotify.playlist-tracks"),{playlist_url:f.value})).data.tracks;a.songs=u.map(n=>({name:n.name,duration:n.duration,duration_seconds:n.duration_seconds,url:n.url,artist:n.artist})),b.value=!1,f.value=""}catch(t){h.value=((e=(i=t.response)==null?void 0:i.data)==null?void 0:e.error)||"Failed to import playlist"}finally{v.value=!1}}},z=()=>{a.post(route("songs.bulk-store",A.band.id),{preserveScroll:!0,onSuccess:()=>{a.reset(),a.songs=[{name:"",duration:"",duration_seconds:"",url:"",artist:""}]}})};return(i,e)=>(d(),m(w,null,[o(s(q),{title:`Add Multiple Songs - ${c.band.name}`},null,8,["title"]),o(R,null,{header:r(()=>[l("div",X,[l("div",J,[l("div",K,[o(s(V),{href:i.route("bands.show",c.band.id),class:"text-sm font-medium text-primary-600 hover:text-primary-700"},{default:r(()=>[p(x(c.band.name),1)]),_:1},8,["href"]),e[5]||(e[5]=l("svg",{class:"mx-2 h-5 w-5 text-neutral-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)),o(s(V),{href:i.route("songs.index",c.band.id),class:"text-sm font-medium text-primary-600 hover:text-primary-700"},{default:r(()=>e[4]||(e[4]=[p(" Songs ")])),_:1},8,["href"])]),e[6]||(e[6]=l("h2",{class:"mt-1 text-2xl font-bold leading-7 text-neutral-900 sm:truncate sm:text-3xl sm:tracking-tight"}," Add Multiple Songs ",-1)),l("p",{class:"mt-1 text-sm text-neutral-500"}," Add up to "+x($)+" songs at once ")])])]),default:r(()=>[o(s(H),null,{default:r(()=>[l("form",{onSubmit:E(z,["prevent"]),class:"divide-y divide-neutral-200"},[Object.keys(s(a).errors).length>0?(d(),C(s(U),{key:0,type:"error",class:"m-6"},{default:r(()=>[l("ul",Q,[(d(!0),m(w,null,M(s(a).errors,t=>(d(),m("li",{key:t},x(t),1))),128))])]),_:1})):k("",!0),(d(!0),m(w,null,M(s(a).songs,(t,u)=>(d(),m("div",{key:u,class:"p-2 flex items-center space-x-4"},[l("div",W,[o(s(g),{modelValue:t.name,"onUpdate:modelValue":n=>t.name=n,type:"text",label:u===0?"Song Name":"",placeholder:"Song name",required:""},null,8,["modelValue","onUpdate:modelValue","label"])]),l("div",Y,[o(s(g),{modelValue:t.duration,"onUpdate:modelValue":n=>t.duration=n,type:"text",label:u===0?"Duration":"",placeholder:"MM:SS",onInput:n=>N(u,n),required:""},null,8,["modelValue","onUpdate:modelValue","label","onInput"])]),l("div",Z,[o(s(g),{modelValue:t.artist,"onUpdate:modelValue":n=>t.artist=n,type:"text",label:u===0?"Artist":"",placeholder:"Artist name"},null,8,["modelValue","onUpdate:modelValue","label"])]),l("div",ee,[o(s(g),{modelValue:t.url,"onUpdate:modelValue":n=>t.url=n,type:"url",label:u===0?"URL":"",placeholder:"https://"},null,8,["modelValue","onUpdate:modelValue","label"])]),l("div",te,[s(a).songs.length>1?(d(),m("button",{key:0,type:"button",class:"h-10 p-2 text-neutral-400 hover:text-danger-500",onClick:n=>B(u)},e[7]||(e[7]=[l("svg",{class:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)]),8,se)):k("",!0)])]))),128)),l("div",le,[l("div",oe,[o(s(y),{type:"button",variant:"secondary",disabled:!S.value,onClick:j},{default:r(()=>e[8]||(e[8]=[l("svg",{class:"-ml-0.5 mr-1.5 h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),p(" Add Another Song ")])),_:1},8,["disabled"]),o(s(y),{type:"button",variant:"secondary",onClick:e[0]||(e[0]=t=>b.value=!0)},{default:r(()=>e[9]||(e[9]=[l("svg",{class:"-ml-0.5 mr-1.5 h-4 w-4",viewBox:"0 0 24 24",fill:"currentColor"},[l("path",{d:"M12 0C5.4 0 0 5.4 0 12s5.4 12 12 12 12-5.4 12-12S18.66 0 12 0zm5.521 17.34c-.24.359-.66.48-1.021.24-2.82-1.74-6.36-2.101-10.561-1.141-.418.122-.779-.179-.899-.539-.12-.421.18-.78.54-.9 4.56-1.021 8.52-.6 11.64 1.32.42.18.479.659.301 1.02zm1.44-3.3c-.301.42-.841.6-1.262.3-3.239-1.98-8.159-2.58-11.939-1.38-.479.12-1.02-.12-1.14-.6-.12-.48.12-1.021.6-1.141C9.6 9.9 15 10.561 18.72 12.84c.361.181.54.78.241 1.2zm.12-3.36C15.24 8.4 8.82 8.16 5.16 9.301c-.6.179-1.2-.181-1.38-.721-.18-.601.18-1.2.72-1.381 4.26-1.26 11.28-1.02 15.721 1.621.539.3.719 1.02.419 1.56-.299.421-1.02.599-1.559.3z"})],-1),p(" Import from Spotify ")])),_:1})]),l("div",ae,[o(s(V),{href:i.route("songs.index",c.band.id)},{default:r(()=>[o(s(y),{variant:"outline"},{default:r(()=>e[10]||(e[10]=[p(" Cancel ")])),_:1})]),_:1},8,["href"]),o(s(y),{type:"submit",variant:"primary",disabled:s(a).processing},{default:r(()=>[s(a).processing?(d(),m("span",ne,"Saving...")):(d(),m("span",re,"Save All Songs"))]),_:1},8,["disabled"])])])],32)]),_:1}),o(s(T),{show:b.value,onClose:e[3]||(e[3]=t=>b.value=!1),"max-width":"lg"},{default:r(()=>[o(s(G),{as:"h3",class:"text-lg font-medium leading-6 text-neutral-900 mb-4"},{default:r(()=>e[11]||(e[11]=[p(" Import from Spotify Playlist ")])),_:1}),l("div",ie,[e[12]||(e[12]=l("p",{class:"text-sm text-neutral-600"}," Enter a Spotify playlist URL or ID to import its tracks. ",-1)),h.value?(d(),C(s(U),{key:0,type:"error",class:"mb-4"},{default:r(()=>[p(x(h.value),1)]),_:1})):k("",!0),o(s(g),{modelValue:f.value,"onUpdate:modelValue":e[1]||(e[1]=t=>f.value=t),label:"Playlist URL",placeholder:"https://open.spotify.com/playlist/...",disabled:v.value},null,8,["modelValue","disabled"])]),l("div",de,[o(s(y),{variant:"outline",onClick:e[2]||(e[2]=t=>b.value=!1),disabled:v.value},{default:r(()=>e[13]||(e[13]=[p(" Cancel ")])),_:1},8,["disabled"]),o(s(y),{variant:"primary",onClick:L,disabled:!f.value||v.value},{default:r(()=>[v.value?(d(),m("span",ue,"Importing...")):(d(),m("span",me,"Import Tracks"))]),_:1},8,["disabled"])])]),_:1},8,["show"])]),_:1})],64))}};export{he as default};
