import{c as o,o as a,b as e,r as l,q as E,e as N,w as S,a as p,u as y,m as q,h as x,t as d,F as B,j as D,d as P,i as L,s as M,G as j,W as F}from"./app-By7LNvvF.js";import{_ as U}from"./AuthenticatedLayout-Bnlojeeg.js";import{_ as V}from"./DSTooltip.vue_vue_type_style_index_0_lang-DhlZjsMt.js";import"./Alert-BZb8NcnJ.js";function Z(s,n){return a(),o("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"fill-rule":"evenodd",d:"M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12Zm13.36-1.814a.75.75 0 1 0-1.22-.872l-3.236 4.53L9.53 12.22a.75.75 0 0 0-1.06 1.06l2.25 2.25a.75.75 0 0 0 1.14-.094l3.75-5.25Z","clip-rule":"evenodd"})])}function A(s,n){return a(),o("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"fill-rule":"evenodd",d:"M12 1.5a5.25 5.25 0 0 0-5.25 5.25v3a3 3 0 0 0-3 3v6.75a3 3 0 0 0 3 3h10.5a3 3 0 0 0 3-3v-6.75a3 3 0 0 0-3-3v-3c0-2.9-2.35-5.25-5.25-5.25Zm3.75 8.25v-3a3.75 3.75 0 1 0-7.5 0v3h7.5Z","clip-rule":"evenodd"})])}const $={class:"max-w-3xl mx-auto py-8 px-4 sm:px-6 lg:px-8"},I={key:0,class:"mb-4 p-4 bg-red-50 border border-red-200 rounded-md"},K={class:"text-red-600"},T={key:1,class:"mb-8 p-4 bg-blue-50 border border-blue-200 rounded-md"},W={class:"text-blue-700"},Y={class:"grid grid-cols-1 gap-8 md:grid-cols-2"},z={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},G={class:"flex justify-between items-center mb-4 pb-4 border-b border-gray-100"},H={class:"font-medium text-gray-900"},O={class:"space-y-3 mb-6"},J={class:"ml-3 text-sm text-gray-600"},Q={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},R={class:"mb-4"},X={class:"mb-6"},ee={key:0,class:"mt-1 text-sm text-red-600"},te={key:0},re={key:1},se={class:"mt-4 flex items-center justify-center text-sm text-gray-500"},ie={__name:"Checkout",props:{band:{type:Object,required:!0,validator:s=>s.name&&typeof s.name=="string"},trialDaysLeft:{type:Number,required:!0},stripeKey:{type:String,required:!0},clientSecret:{type:String,required:!0}},setup(s){const n=s,c=l(null),m=l(null),v=l(""),u=l(!1),b=l(null),h=l(null),f=l(null),k=["Unlimited free band members","Unlimited songs","Unlimited setlists","Full access for all band members","Cloud backup and sync","Performance mode","File attachments support","Priority email support"];E(()=>{b.value=Stripe(n.stripeKey),f.value=b.value.elements();const i=f.value.create("card",{style:{base:{fontSize:"16px",color:"#374151","::placeholder":{color:"#9CA3AF"}}}});i.mount(h.value),i.on("change",t=>{m.value=t.error?t.error.message:""})});const C=async()=>{var i,t;if(!u.value){u.value=!0,m.value=null,c.value=null;try{const{setupIntent:r,error:_}=await b.value.confirmCardSetup(n.clientSecret,{payment_method:{card:f.value.getElement("card"),billing_details:{name:v.value}}});if(_)throw new Error(_.message);console.log("Payment method created:",r.payment_method);const{data:g}=await j.post(route("subscription.create"),{band_id:n.band.id,payment_method:r.payment_method});if(console.log("Subscription response:",g),g.status==="requires_action"){const{error:w}=await b.value.confirmCardPayment(g.payment_intent_client_secret);if(w)throw new Error(w.message)}F.visit(route("bands.show",n.band.id),{preserveScroll:!0})}catch(r){console.error("Subscription error:",r),c.value=((t=(i=r.response)==null?void 0:i.data)==null?void 0:t.message)||r.message||"An error occurred during checkout. Please try again."}finally{u.value=!1}}};return(i,t)=>(a(),N(U,null,{default:S(()=>[p(y(q),{title:"Subscribe to Setlix"}),e("div",$,[c.value?(a(),o("div",I,[e("p",K,d(c.value),1)])):x("",!0),s.trialDaysLeft>0?(a(),o("div",T,[e("p",W," You have "+d(s.trialDaysLeft)+" days left in your trial period for "+d(s.band.name),1)])):x("",!0),e("div",Y,[e("div",null,[e("div",z,[t[3]||(t[3]=e("h2",{class:"text-xl font-semibold text-gray-900 mb-4"},"Subscription Details",-1)),e("div",G,[e("div",null,[e("p",H,d(s.band.name),1),t[1]||(t[1]=e("p",{class:"text-sm text-gray-500"},"Monthly Subscription",-1))]),t[2]||(t[2]=e("div",{class:"text-right"},[e("p",{class:"text-lg font-bold text-gray-900"},"£10.00"),e("p",{class:"text-sm text-gray-500"},"per month")],-1))]),e("ul",O,[(a(),o(B,null,D(k,r=>e("li",{key:r,class:"flex items-start"},[p(y(Z),{class:"h-5 w-5 text-green-500 flex-shrink-0"}),e("span",J,d(r),1)])),64))])])]),e("div",Q,[t[7]||(t[7]=e("h2",{class:"text-xl font-semibold text-gray-900 mb-4"},"Payment Information",-1)),e("form",{onSubmit:P(C,["prevent"])},[e("div",R,[t[4]||(t[4]=e("label",{for:"cardName",class:"block text-sm font-medium text-gray-700 mb-1"}," Card Holder Name ",-1)),L(e("input",{id:"cardName","onUpdate:modelValue":t[0]||(t[0]=r=>v.value=r),type:"text",class:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",required:""},null,512),[[M,v.value]])]),e("div",X,[t[5]||(t[5]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Card Details ",-1)),e("div",{ref_key:"cardElement",ref:h,class:"p-3 border rounded-md border-gray-300 bg-white"},null,512),m.value?(a(),o("div",ee,d(m.value),1)):x("",!0)]),p(y(V),{type:"submit",variant:"primary",class:"w-full justify-center",disabled:u.value},{default:S(()=>[u.value?(a(),o("span",te,"Processing...")):(a(),o("span",re,"Subscribe Now • £10/month"))]),_:1},8,["disabled"])],32),e("div",se,[p(y(A),{class:"h-4 w-4 mr-1"}),t[6]||(t[6]=e("span",null,"Secure payment powered by Stripe",-1))])])]),t[8]||(t[8]=e("div",{class:"mt-6 text-center text-sm text-gray-500"},[e("p",null,"By subscribing, you agree to our Terms of Service. You can cancel anytime.")],-1))])]),_:1}))}};export{ie as default};
