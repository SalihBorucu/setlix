import{r as g,c as l,o as s,a as p,u as c,m as B,w as u,h as a,b as o,t as m,F as f,j as F,f as d,n as V,e as h,P as w,W as A}from"./app-CbefnPLH.js";import{_ as M}from"./AuthenticatedLayout-B4MUKnYn.js";import{_ as v}from"./DSTooltip.vue_vue_type_style_index_0_lang-8fPiiRMW.js";import{_ as N}from"./ConfirmModal-DMzbEy5z.js";import"./Alert-DjKDwrjq.js";import"./Modal-BeLdYnw-.js";import"./transition-DDZigcgj.js";const T={key:0,class:"bg-white rounded-lg shadow p-6 mb-6"},D={class:"text-2xl font-bold text-primary-600"},Y={class:"bg-white rounded-lg shadow overflow-hidden"},$={class:"divide-y divide-neutral-200"},P={class:"flex items-center justify-between"},j={class:"text-lg font-medium text-neutral-900"},I={class:"text-sm text-neutral-500"},U={key:0,class:"text-sm text-neutral-500"},W={key:1,class:"text-sm text-neutral-500"},q={key:1,class:"text-sm text-neutral-500 mt-1"},z={class:"font-medium"},E={class:"flex gap-3"},G={key:1,class:"px-3 py-1 bg-yellow-100 text-yellow-800 rounded-full text-sm font-medium"},Z={__name:"Index",props:{subscriptions:{type:Array,required:!0}},setup(y){const b={totalMonthlyFee:i=>i.filter(t=>{var e,r;return((e=t.subscription)==null?void 0:e.status)==="active"&&((r=t.subscription)==null?void 0:r.is_owner)}).reduce((t,e)=>{var r;return t+(((r=e.subscription)==null?void 0:r.price)||0)},0)},x=g(!1),_=g(null),k=i=>{_.value=i,x.value=!0},C=()=>{_.value&&A.delete(route("subscription.cancel",_.value.id))},n=i=>i.subscription&&i.subscription.status||"inactive",S=i=>{if(!i)return"";const t=new Date(i);return new Intl.DateTimeFormat("en-GB",{day:"numeric",month:"long",year:"numeric"}).format(t)};return(i,t)=>(s(),l(f,null,[p(c(B),{title:"Subscriptions"}),p(M,null,{header:u(()=>t[1]||(t[1]=[o("h2",{class:"text-2xl font-bold text-neutral-900"}," Manage Band Subscriptions ",-1)])),default:u(()=>[y.subscriptions.some(e=>{var r;return(r=e.subscription)==null?void 0:r.is_owner})?(s(),l("div",T,[t[2]||(t[2]=o("h3",{class:"text-lg font-medium text-neutral-900 mb-2"},"Your Total Monthly Fee",-1)),o("p",D,"£"+m(b.totalMonthlyFee(y.subscriptions).toFixed(2))+"/month",1)])):a("",!0),o("div",Y,[o("ul",$,[(s(!0),l(f,null,F(y.subscriptions,e=>{var r;return s(),l("li",{key:e.id,class:"p-6"},[o("div",P,[o("div",null,[o("h4",j,m(e.name),1),o("p",I,[t[3]||(t[3]=d(" Status: ")),o("span",{class:V({"text-green-600":n(e)==="active","text-yellow-600":n(e)==="trialing","text-red-600":n(e)==="inactive","text-orange-600":n(e)==="payment_failed","text-gray-600":n(e)==="cancelled"})},m(n(e)),3)]),e.subscription?(s(),l(f,{key:0},[e.subscription.is_owner?(s(),l("p",U," You are paying £"+m(e.subscription.price)+"/month ",1)):(s(),l("p",W," Subscription managed by "+m(e.subscription.owner_name),1))],64)):a("",!0),n(e)==="cancelled"&&((r=e.subscription)!=null&&r.ends_at)?(s(),l("p",q,[t[4]||(t[4]=d(" Access until: ")),o("span",z,m(S(e.subscription.ends_at)),1)])):a("",!0)]),o("div",E,[!e.subscription||e.subscription.is_owner?(s(),l(f,{key:0},[["inactive","cancelled"].includes(n(e))?(s(),h(c(w),{key:0,href:i.route("subscription.checkout",e.id)},{default:u(()=>[p(c(v),{variant:"primary"},{default:u(()=>t[5]||(t[5]=[d(" Subscribe ")])),_:1})]),_:2},1032,["href"])):a("",!0),n(e)==="payment_failed"?(s(),h(c(w),{key:1,href:i.route("subscription.checkout",e.id)},{default:u(()=>[p(c(v),{variant:"warning"},{default:u(()=>t[6]||(t[6]=[d(" Update Payment ")])),_:1})]),_:2},1032,["href"])):a("",!0),n(e)==="active"?(s(),h(c(v),{key:2,variant:"danger",onClick:K=>k(e)},{default:u(()=>t[7]||(t[7]=[d(" Cancel ")])),_:2},1032,["onClick"])):a("",!0)],64)):a("",!0),n(e)==="trialing"?(s(),l("div",G," Trial Active ")):a("",!0)])])])}),128))])]),p(N,{modelValue:x.value,"onUpdate:modelValue":t[0]||(t[0]=e=>x.value=e),title:"Cancel Subscription",description:"Are you sure you want to cancel this subscription? Your band will continue to have access until the end of the billing period. After that, you'll lose access to premium features unless you resubscribe.","confirm-text":"Yes, Cancel Subscription","cancel-text":"No, Keep Subscription","confirm-variant":"danger",onConfirm:C},null,8,["modelValue"])]),_:1})],64))}};export{Z as default};
