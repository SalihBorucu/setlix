import{c as i,o as a,b as e,r as l,q as E,e as N,w as C,a as y,u as f,m as D,h,t as o,F as B,j,d as I,i as L,s as M,G as F,W as U}from"./app-DBENn6a9.js";import{_ as V}from"./AuthenticatedLayout-CEnXp21Z.js";import{_ as Z}from"./DSTooltip.vue_vue_type_style_index_0_lang-_HS0oTHj.js";/* empty css            */import"./Alert-C7Sw3dcN.js";function A(s,r){return a(),i("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"fill-rule":"evenodd",d:"M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12Zm13.36-1.814a.75.75 0 1 0-1.22-.872l-3.236 4.53L9.53 12.22a.75.75 0 0 0-1.06 1.06l2.25 2.25a.75.75 0 0 0 1.14-.094l3.75-5.25Z","clip-rule":"evenodd"})])}function $(s,r){return a(),i("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"fill-rule":"evenodd",d:"M12 1.5a5.25 5.25 0 0 0-5.25 5.25v3a3 3 0 0 0-3 3v6.75a3 3 0 0 0 3 3h10.5a3 3 0 0 0 3-3v-6.75a3 3 0 0 0-3-3v-3c0-2.9-2.35-5.25-5.25-5.25Zm3.75 8.25v-3a3.75 3.75 0 1 0-7.5 0v3h7.5Z","clip-rule":"evenodd"})])}const K={class:"max-w-3xl mx-auto py-8 px-4 sm:px-6 lg:px-8"},O={key:0,class:"mb-4 p-4 bg-red-50 border border-red-200 rounded-md"},T={class:"text-red-600"},W={key:1,class:"mb-8 p-4 bg-blue-50 border border-blue-200 rounded-md"},Y={class:"text-blue-700"},z={class:"grid grid-cols-1 gap-8 md:grid-cols-2"},G={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},H={class:"flex justify-between items-center mb-4 pb-4 border-b border-gray-100"},J={class:"font-medium text-gray-900"},Q={class:"text-right"},R={class:"text-lg font-bold text-gray-900"},X={class:"space-y-3 mb-6"},ee={class:"ml-3 text-sm text-gray-600"},te={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},re={class:"mb-4"},se={class:"mb-6"},ae={key:0,class:"mt-1 text-sm text-red-600"},oe={key:0},ie={key:1},ne={class:"mt-4 flex items-center justify-center text-sm text-gray-500"},pe={__name:"Checkout",props:{band:{type:Object,required:!0,validator:s=>s.name&&typeof s.name=="string"},trialDaysLeft:{type:Number,required:!0},stripeKey:{type:String,required:!0},clientSecret:{type:String,required:!0},formattedPrice:{type:String,required:!0},pricing:{type:Object,required:!0,default:()=>({})},priceId:{type:String,required:!0}},setup(s){const r=s;console.log("Checkout props:",{band:r.band,pricing:r.pricing,priceId:r.priceId,formattedPrice:r.formattedPrice});const m=l(null),p=l(null),g=l(""),c=l(!1),b=l(null),_=l(null),v=l(null),P=["Unlimited free band members","Unlimited songs","Unlimited setlists","Full access for all band members","Cloud backup and sync","Performance mode","File attachments support","Priority email support"];E(()=>{b.value=Stripe(r.stripeKey),v.value=b.value.elements();const d=v.value.create("card",{style:{base:{fontSize:"16px",color:"#374151","::placeholder":{color:"#9CA3AF"}}}});d.mount(_.value),d.on("change",t=>{p.value=t.error?t.error.message:""})});const q=async()=>{var d,t,n;if(!c.value){c.value=!0,p.value=null,m.value=null;try{const{setupIntent:u,error:w}=await b.value.confirmCardSetup(r.clientSecret,{payment_method:{card:v.value.getElement("card"),billing_details:{name:g.value}}});if(w)throw new Error(w.message);const x={band_id:r.band.id,payment_method:u.payment_method,price_id:r.priceId};(d=r.pricing)!=null&&d.currency&&(x.currency=r.pricing.currency,x.amount=r.pricing.amount);const{data:S}=await F.post(route("subscription.create"),x);if(S.status==="requires_action"){const{error:k}=await b.value.confirmCardPayment(S.payment_intent_client_secret);if(k)throw new Error(k.message)}U.visit(route("subscription.index"),{preserveScroll:!0})}catch(u){console.error("Subscription error:",u),m.value=((n=(t=u.response)==null?void 0:t.data)==null?void 0:n.message)||u.message||"An error occurred during checkout. Please try again."}finally{c.value=!1}}};return(d,t)=>(a(),N(V,null,{default:C(()=>[y(f(D),{title:"Subscribe to Setlix"}),e("div",K,[m.value?(a(),i("div",O,[e("p",T,o(m.value),1)])):h("",!0),s.trialDaysLeft>0?(a(),i("div",W,[e("p",Y," You have "+o(s.trialDaysLeft)+" days left in your trial period for "+o(s.band.name),1)])):h("",!0),e("div",z,[e("div",null,[e("div",G,[t[3]||(t[3]=e("h2",{class:"text-xl font-semibold text-gray-900 mb-4"},"Subscription Details",-1)),e("div",H,[e("div",null,[e("p",J,o(s.band.name),1),t[1]||(t[1]=e("p",{class:"text-sm text-gray-500"},"Monthly Subscription",-1))]),e("div",Q,[e("p",R,o(s.formattedPrice),1),t[2]||(t[2]=e("p",{class:"text-sm text-gray-500"},"per month",-1))])]),e("ul",X,[(a(),i(B,null,j(P,n=>e("li",{key:n,class:"flex items-start"},[y(f(A),{class:"h-5 w-5 text-green-500 flex-shrink-0"}),e("span",ee,o(n),1)])),64))])])]),e("div",te,[t[7]||(t[7]=e("h2",{class:"text-xl font-semibold text-gray-900 mb-4"},"Payment Information",-1)),e("form",{onSubmit:I(q,["prevent"])},[e("div",re,[t[4]||(t[4]=e("label",{for:"cardName",class:"block text-sm font-medium text-gray-700 mb-1"}," Card Holder Name ",-1)),L(e("input",{id:"cardName","onUpdate:modelValue":t[0]||(t[0]=n=>g.value=n),type:"text",class:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",required:""},null,512),[[M,g.value]])]),e("div",se,[t[5]||(t[5]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Card Details ",-1)),e("div",{ref_key:"cardElement",ref:_,class:"p-3 border rounded-md border-gray-300 bg-white"},null,512),p.value?(a(),i("div",ae,o(p.value),1)):h("",!0)]),y(f(Z),{type:"submit",variant:"primary",class:"w-full justify-center",disabled:c.value},{default:C(()=>[c.value?(a(),i("span",oe,"Processing...")):(a(),i("span",ie,"Subscribe Now â€¢ "+o(s.formattedPrice)+"/month",1))]),_:1},8,["disabled"])],32),e("div",ne,[y(f($),{class:"h-4 w-4 mr-1"}),t[6]||(t[6]=e("span",null,"Secure payment powered by Stripe",-1))])])]),t[8]||(t[8]=e("div",{class:"mt-6 text-center text-sm text-gray-500"},[e("p",null,"By subscribing, you agree to our Terms of Service. You can cancel anytime.")],-1))])]),_:1}))}};export{pe as default};
