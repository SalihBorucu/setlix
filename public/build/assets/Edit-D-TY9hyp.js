import{C as A,r as g,c as u,o as p,a,u as o,m as L,w as c,b as e,d as q,h as P,i as S,n as G,q as W,F as _,j as C,t as w,P as D,f as k,a7 as z,W as M}from"./app-D8OPSLji.js";import{_ as H}from"./AuthenticatedLayout-DTlQNGiu.js";import{_ as V}from"./Button-D80aJfgU.js";import{_ as f}from"./Input-CpHXBpmC.js";import{_ as I}from"./AlertModal-BZPHqPCR.js";import"./Modal-C9D4Vs5g.js";import"./transition-D3X4x4mI.js";const R={class:"flex justify-between items-center"},X={class:"text-sm text-gray-600"},Y={class:"py-12"},J={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},K={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},Q={class:"p-6"},Z={class:"grid grid-cols-2 gap-4"},ee={class:"mt-1"},te={key:0,class:"space-y-4"},se={class:"space-y-2"},oe={class:"flex-1"},ne={class:"text-sm font-medium text-neutral-900"},le={class:"text-sm text-neutral-500"},re={class:"flex items-center space-x-2"},ae=["onClick"],ie={class:"space-y-4"},de={class:"flex justify-between items-center"},ue={class:"space-y-2"},pe={class:"flex-1"},me=["onUpdate:modelValue"],ce={class:"flex-1"},fe=["onChange"],ve=["onClick"],be={class:"flex items-center justify-end gap-4"},ge={key:0},ye={key:1},Ce={__name:"Edit",props:{band:{type:Object,required:!0},song:{type:Object,required:!0}},setup(d){const r=d,s=A({band_id:r.band.id,name:r.song.name,artist:r.song.artist,bpm:r.song.bpm,duration_seconds:r.song.duration_seconds,notes:r.song.notes,url:r.song.url,files:[]}),F=n=>{const t=Math.floor(n/60),i=n%60;return`${t}:${i.toString().padStart(2,"0")}`},$=n=>{const[t,i]=n.split(":").map(Number);return t*60+i},y=g(F(r.song.duration_seconds)),T=()=>{const n=y.value;/^\d+:\d{2}$/.test(n)?s.duration_seconds=$(n):s.duration_seconds=r.song.duration_seconds},m=g([]),x=g(null),h=g(null),N=()=>{m.value.length<10&&m.value.push({type:"",file:null})},U=n=>{m.value.splice(n,1)},j=(n,t)=>{const i=n.target.files[0];i&&(m.value[t].file=i)},B=n=>{h.value=n,x.value.open()},E=()=>{M.delete(route("songs.files.destroy",[r.band.id,r.song.id,h.value.id]),{preserveScroll:!0,onSuccess:()=>{x.value.close(),h.value=null}})},O=()=>{T();const n=new FormData;n.append("_method","PATCH"),n.append("band_id",s.band_id.toString()),n.append("name",s.name),n.append("duration_seconds",s.duration_seconds.toString()),s.artist&&n.append("artist",s.artist),s.bpm&&n.append("bpm",s.bpm.toString()),s.notes&&n.append("notes",s.notes),s.url&&n.append("url",s.url),m.value.filter(t=>t.file&&t.type).forEach((t,i)=>{n.append(`files[${i}][type]`,t.type),n.append(`files[${i}][file]`,t.file)}),M.post(route("songs.update",[r.band.id,r.song.id]),n,{preserveScroll:!0,forceFormData:!0})};return(n,t)=>(p(),u(_,null,[a(o(L),{title:`Edit ${d.song.name} - ${d.band.name}`},null,8,["title"]),a(H,null,{header:c(()=>[e("div",R,[e("div",null,[t[6]||(t[6]=e("h2",{class:"text-xl font-semibold leading-tight text-gray-800"}," Edit Song ",-1)),e("p",X,w(d.band.name),1)])])]),default:c(()=>{var i;return[e("div",Y,[e("div",J,[e("div",K,[e("div",Q,[e("form",{onSubmit:q(O,["prevent"]),class:"space-y-6"},[e("div",Z,[e("div",null,[a(o(f),{modelValue:o(s).name,"onUpdate:modelValue":t[0]||(t[0]=l=>o(s).name=l),type:"text",label:"Song Name",error:o(s).errors.name,required:""},null,8,["modelValue","error"])]),e("div",null,[a(o(f),{modelValue:o(s).artist,"onUpdate:modelValue":t[1]||(t[1]=l=>o(s).artist=l),type:"text",label:"Artist (Optional)",error:o(s).errors.artist,placeholder:""},null,8,["modelValue","error"])]),e("div",null,[a(o(f),{modelValue:y.value,"onUpdate:modelValue":t[2]||(t[2]=l=>y.value=l),type:"text",label:"Duration (MM:SS)",error:o(s).errors.duration_seconds,required:"",pattern:"[0-9]{1,2}:[0-9]{2}",placeholder:"03:30"},null,8,["modelValue","error"])]),e("div",null,[a(o(f),{modelValue:o(s).bpm,"onUpdate:modelValue":t[3]||(t[3]=l=>o(s).bpm=l),type:"number",label:"BPM (Optional)",error:o(s).errors.bpm},null,8,["modelValue","error"])])]),e("div",null,[t[7]||(t[7]=e("label",{class:"block text-sm font-medium text-neutral-700"}," Notes (Optional) ",-1)),e("div",ee,[S(e("textarea",{"onUpdate:modelValue":t[4]||(t[4]=l=>o(s).notes=l),rows:"4",class:G(["block w-full rounded-lg shadow-sm transition-colors duration-200","border-neutral-300 focus:border-primary-500 focus:ring-primary-500",{"border-error-500 focus:border-error-500 focus:ring-error-500":o(s).errors.notes}])},null,2),[[W,o(s).notes]])]),t[8]||(t[8]=e("p",{class:"mt-1 text-sm text-neutral-500"}," Add any notes about the song, such as key changes or special instructions ",-1))]),e("div",null,[a(o(f),{modelValue:o(s).url,"onUpdate:modelValue":t[5]||(t[5]=l=>o(s).url=l),type:"url",label:"External Link (Optional)",error:o(s).errors.url,placeholder:"https://"},null,8,["modelValue","error"]),t[9]||(t[9]=e("p",{class:"mt-1 text-sm text-neutral-500"}," Link to an external resource (YouTube, Spotify, etc.) ",-1))]),(i=d.song.files)!=null&&i.length?(p(),u("div",te,[t[12]||(t[12]=e("h3",{class:"text-lg font-medium text-neutral-900"},"Existing Files",-1)),e("div",se,[(p(!0),u(_,null,C(d.song.files,l=>(p(),u("div",{key:l.id,class:"flex items-center gap-4 border rounded-md p-3"},[e("div",oe,[e("span",ne,w(l.type),1),e("p",le,w(l.original_filename),1)]),e("div",re,[a(o(D),{href:n.route("songs.files.download",[d.band.id,d.song.id,l.id]),class:"text-primary-600 hover:text-primary-700"},{default:c(()=>t[10]||(t[10]=[k(" Download ")])),_:2},1032,["href"]),e("button",{type:"button",onClick:v=>B(l),class:"text-neutral-400 hover:text-neutral-500"},t[11]||(t[11]=[e("span",{class:"sr-only"},"Delete",-1),e("svg",{class:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]),8,ae)])]))),128))])])):P("",!0),e("div",ie,[e("div",de,[t[14]||(t[14]=e("h3",{class:"text-lg font-medium text-neutral-900"},"Add New Files",-1)),a(o(V),{type:"button",variant:"secondary",onClick:N,disabled:m.value.length>=10},{default:c(()=>t[13]||(t[13]=[k(" Add File ")])),_:1},8,["disabled"])]),e("div",ue,[(p(!0),u(_,null,C(m.value,(l,v)=>(p(),u("div",{key:v,class:"flex items-center gap-4 border rounded-md p-3"},[e("div",pe,[S(e("select",{"onUpdate:modelValue":b=>l.type=b,class:"block w-full rounded-md border-neutral-300 shadow-sm focus:border-primary-500 focus:ring-primary-500"},t[15]||(t[15]=[e("option",{value:""},"Select Type",-1),e("option",{value:"lyrics"},"Lyrics",-1),e("option",{value:"notes"},"Notes",-1),e("option",{value:"chords"},"Chords",-1),e("option",{value:"tabs"},"Tabs",-1),e("option",{value:"sheet_music"},"Sheet Music",-1),e("option",{value:"other"},"Other",-1)]),8,me),[[z,l.type]])]),e("div",ce,[e("input",{type:"file",onChange:b=>j(b,v),accept:".pdf,.txt",class:"block w-full text-sm"},null,40,fe)]),e("button",{type:"button",onClick:b=>U(v),class:"text-neutral-400 hover:text-neutral-500"},t[16]||(t[16]=[e("span",{class:"sr-only"},"Remove",-1),e("svg",{class:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]),8,ve)]))),128))]),t[17]||(t[17]=e("p",{class:"text-sm text-neutral-500"},"PDF or TXT files up to 10MB",-1))]),e("div",be,[a(o(D),{href:n.route("songs.show",[d.band.id,d.song.id])},{default:c(()=>[a(o(V),{type:"button",variant:"outline"},{default:c(()=>t[18]||(t[18]=[k(" Cancel ")])),_:1})]),_:1},8,["href"]),a(o(V),{type:"submit",variant:"primary",disabled:o(s).processing},{default:c(()=>[o(s).processing?(p(),u("span",ge,"Saving...")):(p(),u("span",ye,"Save Changes"))]),_:1},8,["disabled"])])],32)])])])])]}),_:1}),a(o(I),{ref_key:"deleteModal",ref:x,title:"Delete File",message:"Are you sure you want to delete this file? This action cannot be undone.",type:"error","confirm-text":"Delete","show-cancel":!0,onConfirm:E},null,512)],64))}};export{Ce as default};
